---
title: "Astroã§Webåˆ¶ä½œã™ã‚‹æ™‚ã®Tips"
emoji: "ğŸ˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [astro]
published: true
---

ã“ã‚Œã¾ã§Astroã‚’è§¦ã£ã¦ãã¦å½¹ã«ç«‹ã£ãŸTipsã®ã¾ã¨ã‚ã€‚

## Sassã‚’ä½¿ã†

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```shell
npm i sass
```

### mixinã‚’å„scssãƒ•ã‚¡ã‚¤ãƒ«ã«importã™ã‚‹
æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’`astro.config.mjs`ã«è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€æ¯å›`@use`ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¾ãªãã¦ã‚‚ã€ã™ã¹ã¦ã®scssãƒ•ã‚¡ã‚¤ãƒ«ã§mixinãªã©ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚<br/>æ¬¡ã®ä¾‹ã ã¨ã€`styles/_variables.scss`ã«è¨˜è¿°ã—ãŸmixinãŒã™ã¹ã¦ã®scssãƒ•ã‚¡ã‚¤ãƒ«ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚

```diff js:astro.config.mjs
import { defineConfig } from "astro/config";

// https://astro.build/config
export default defineConfig({
  vite: {
+   css: {
+     preprocessorOptions: {
+       scss: {
+         additionalData: '@use "src/styles/_variables.scss" as *;',
+       },
+     },
+   },
  },
});
```

@useã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãªãã¦ã‚‚ä½¿ç”¨ã§ãã‚‹ âœ¨
```css:Menu.astro
.menu {
    margin: 0;
    padding: 0 1em;
    background: white;

    @include mq(sm) {
        display: none;
    }
}
```

## Vercelã¸ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹

### Vercelã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```shell
npx astro add vercel
```

### è³ªå•ã«ç­”ãˆã¦ã„ã
**Yes**
```shell
 Astro will run the following command:
  If you skip this step, you can always run it yourself late

 npm install @astrojs/vercel 
 ```

 ---

**Noï¼ˆSSRã™ã‚‹å ´åˆã¯yesï¼‰**
```shell
 Astro will make the following changes to your config file:

- astro.config.mjs
import { defineConfig } from "astro/config"; 
import vercel from "@astrojs/vercel/serverless";

export default defineConfig({ ãƒ»ãƒ»ãƒ» çœç•¥
```

### ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
Vercelã®ç®¡ç†ç”»é¢ã§å¯¾è±¡ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã€å„è¨­å®šã‚’ã™ã‚Œã°ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº† ğŸŠ

## Taillwind CSSã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
https://docs.astro.build/ja/guides/integrations-guide/tailwind/

### ã‚³ãƒãƒ³ãƒ‰

```shell
# npmã®å ´åˆ
npx astro add tailwind

# yarnã®å ´åˆ
yarn astro add tailwind

# pnpmã®å ´åˆ
pnpm astro add tailwind
```

## Prettierã‚’å°å…¥ã™ã‚‹

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
Prettierã¨Astroç”¨ã®Prettierã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```shell
npm install prettier-plugin-astro prettier
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¤ãã‚‹
ãƒ«ãƒ¼ãƒˆç›´ä¸‹ã«æ¬¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦è¨­å®šã‚’è¡Œã†

```js:.prettierrc.cjs
module.exports = {
  plugins: [require.resolve('prettier-plugin-astro')],
  overrides: [
    {
      files: '*.astro',
      options: {
        parser: 'astro',
      },
    },
  ],
};
```

### NPMã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¿½åŠ 
```diff js:package.json
{
    "scripts": {
    "dev": "astro dev",
    "start": "astro dev",
    "build": "astro build",
    "preview": "astro preview",
    "astro": "astro",
+   "prettier": "prettier --write 'src/**/*.{ts,js,astro,css,scss}'",
  },
}
```


### ä¿å­˜æ™‚ã«è‡ªå‹•æ•´å½¢ã™ã‚‹
```js:.vscode/settings.json
{
  "editor.formatOnSave": true,
  "[astro]": {
    "editor.formatOnSave": false
  },
}
```

## pnpm ã‚’ä½¿ç”¨ã—ãŸã¨ãã«buildãŒé€šã‚‰ãªã„ã‚¨ãƒ©ãƒ¼ã®è§£æ±ºæ³•

### ã‚¨ãƒ©ãƒ¼å†…å®¹
pnpm buildã‚’ã™ã‚‹ã¨æ¬¡ã®ã‚¨ãƒ©ãƒ¼ãŒã§ã‚‹

```shell
generating optimized images
node:internal/process/promises:288
            triggerUncaughtException(err, true /* fromPromise */);
            ^

MissingSharp: Could not find Sharp. Please install Sharp (`sharp`) manually into your project or migrate to another image service.
```

### è§£æ±ºæ³•
Astroã¯ç”»åƒå‡¦ç†ã«Sharpã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŒã€pnpmã®ã‚ˆã†ãªå³æ ¼ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€æ‰‹å‹•ã§Sharpã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

```shell
pnpm i sharp
```

https://docs.astro.build/ja/reference/errors/missing-sharp/#what-went-wrong

## ãƒ•ã‚©ãƒ³ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€é©åŒ–ã™ã‚‹
ä¸‹è¨˜ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãƒ•ã‚©ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒã‚ãŒã‚‹ã€‚<br/>Next.jsã®ãƒ•ã‚©ãƒ³ãƒˆæœ€é©åŒ–ã«ã‚¤ãƒ³ã‚¹ãƒ‘ã‚¤ã‚¢ã•ã‚Œã¦ä½œã‚‰ã‚ŒãŸã‚‰ã—ã„ã€‚

https://github.com/sebholstein/astro-google-fonts-optimizer

### ä½¿ã„æ–¹
1. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```sh
pnpm add astro-google-fonts-optimizer
```

2. <head>å†…ã«åŸ‹ã‚è¾¼ã‚€
```diff jsx:layout.astro
---
+ import { GoogleFontsOptimizer } from 'astro-google-fonts-optimizer';

ãƒ»ãƒ»ãƒ»çœç•¥
---

  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Astro description" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
+   <GoogleFontsOptimizer url="https://fonts.googleapis.com/css2family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" />
    <title>{title}</title>
  </head>
```

3. CSSã§ãƒ•ã‚©ãƒ³ãƒˆã‚’æŒ‡å®šã™ã‚‹
```css:global.css
body {
    font-family: Montserrat, sans-serif;
}
```

:::details Tailwind CSSã®å ´åˆ

```diff js:tailwind.config.js
/** @type {import('tailwindcss').Config} */
export default {
  content: ['./src/**/*.{astro,html,js,jsx,md,mdx,svelte,ts,tsx,vue}'],
  theme: {
    extend: {
+    fontFamily: {
+      montserrat: ['Montserrat', 'sans-serif'],
+    },
    },
  },
 ãƒ»ãƒ»ãƒ»çœç•¥
};
```

```css:global.css
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html,
  body {
    @apply font-montserrat;
  }
}
```
:::

## Astro Sitemapã§ XMLã‚µã‚¤ãƒˆãƒãƒƒãƒ—ã‚’ç”Ÿæˆã™ã‚‹
å…¬å¼ã®ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚ã‚‹ã®ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚
https://docs.astro.build/en/guides/integrations-guide/sitemap/

```shell
pnpm astro add sitemap
```

`astro.config.mjs`ã«`integrations`ã¨`site`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½è¨˜ã™ã‚‹ã€‚
```js:astro.config.mjs
import { defineConfig } from 'astro/config';
import sitemap from '@astrojs/sitemap';

export default defineConfig({
  // ...
  site: 'https://example.jp',
  integrations: [sitemap()],
});
```

## ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®è¨­å®š
`import`ã‚’ã™ã¹ã¦ç›¸å¯¾ãƒ‘ã‚¹ã§æ›¸ãã®ã¯å¤§å¤‰ãªã®ã§ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ã‚¤ãƒªã‚¢ã‚¹ã§çµ¶å¯¾ãƒ‘ã‚¹ã§importã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

https://docs.astro.build/ja/guides/aliases/

```js:tsconfig.json
{
  "extends": "astro/tsconfigs/base",
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@/js/*": ["src/assets/js/*"]
    }
  }
}
```

## ã‚«ãƒ¬ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹
ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã§ä½¿ç”¨ã™ã‚‹ã€ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã®æ™‚ã«ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã›ã‚‹æ–¹æ³•ã€‚

```jsx:src/components/NavLink.astro
---
const { pathname } = Astro.url;

// pathnameï¼ˆURLã®ãƒ‘ã‚¹éƒ¨åˆ†ã‚’è¡¨ã™æ–‡å­—åˆ—ï¼‰ã‹ã‚‰ã‚¹ãƒ©ãƒƒã‚·ãƒ¥(/)ã«ã‚ˆã£ã¦åŒºåˆ‡ã‚‰ã‚ŒãŸã™ã¹ã¦ã®éƒ¨åˆ†ï¼ˆã‚µãƒ–ãƒ‘ã‚¹ï¼‰ã‚’æŠ½å‡º
// pathnameãŒ ./blog/article ã§ã‚ã‚Œã° blog ã¨ article ã‚’å–å¾—ã™ã‚‹
const subpath = pathname.match(/[^\/]+/g);

// ç¾åœ¨ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ï¼ˆpathnameã§è¡¨ã•ã‚Œã‚‹ï¼‰ã¨åŒã˜ã§ã‚ã‚‹ã‹ã€ã¾ãŸã¯pathnameã®æœ€åˆã®ã‚µãƒ–ãƒ‘ã‚¹ã«ç›¸å½“ã™ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã€‚
const isActive = href === pathname || href === `/${subpath?.[0]}`;
---

<a href={href} class:list={["link",className, { active: isActive }]} {...props}>
    Link
</a>

<style lang="scss">
  .active {
    text-decoration: underline;
    text-underline-offset: 6px;
    text-decoration-thickness: 2px;
  }
</style>
```

è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§`NavLink`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å‘¼ã³ã ã—ã¦ä½¿ç”¨ã™ã‚‹ã€‚
```jsx:src/components/Header.astro
---
import NavLink from './NavLink.astro'
---

<header class="header">
  <nav class="nav">
    <a href="/" class="logo">LOGO</a>
    <div class="links">
      <div class="internal-links">
        <NavLink href="/">HOME</NavLink>
        <NavLink href="/blog">BLOG</NavLink>
        <NavLink href="/contact">CONTACT</NavLink>
      </div>
    </div>
  </nav>
</header>

<style lang="scss">
  .links {
    display: flex;
    align-items: center;
  }
</style>
```

## `class:list`ã§classã‚’å‹•çš„ã«åˆ¶å¾¡ã™ã‚‹
`Astro.props`ã‹ã‚‰classãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å–å¾—ã—ã€ãã‚Œã‚’classNameã¨ã„ã†åå‰ã®å¤‰æ•°ã«å‰²ã‚Šå½“ã¦ã€Astroã®`class:list`å±æ€§ã§`container`ã¨ã„ã†ã‚¯ãƒ©ã‚¹åã¨ã€classNameå¤‰æ•°ã®å€¤ãŒå«ã¾ã‚Œã‚‹é…åˆ—ã‚’æ¸¡ã™ã€‚

`<div>`è¦ç´ ã«ã¯å¸¸ã«`container`ã‚¯ãƒ©ã‚¹ãŒé©ç”¨ã•ã‚Œã€ã•ã‚‰ã«classNameå¤‰æ•°ã«å€¤ãŒã‚ã‚Œã°ã€ãã®ã‚¯ãƒ©ã‚¹ã‚‚é©ç”¨ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚

```jsx:src/components/Container.astro
---
const { class: className} = Astro.props
---

<div class:list={["container", className]} {...props}>
    <slot/>
</div>

<style>
  .container {
    max-width: 1200px;
    margin-inline: auto;
  }
</style>
```

ã“ã†ã™ã‚‹ã“ã¨ã§å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´ã§ã®ã¿`wide`ã‚¯ãƒ©ã‚¹ã«CSSã‚’è¨­å®šã§ãã‚‹ã€‚classãŒç©ºã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ«ã®ã¿é©ç”¨ã•ã‚Œã‚‹ã€‚
```html:index.astro
<Container class="wide">
    <h1>Title</h1>
</Container>
```